CREATE DATABASE IF NOT EXISTS `ninjatooken`;
CREATE TABLE nt_clan (id INT AUTO_INCREMENT NOT NULL, old_id INT DEFAULT NULL, nom VARCHAR(255) NOT NULL, tag VARCHAR(5) DEFAULT NULL, accroche VARCHAR(255) DEFAULT NULL, description LONGTEXT NOT NULL, url VARCHAR(255) DEFAULT NULL, kamon VARCHAR(255) DEFAULT NULL, kamon_upload VARCHAR(255) DEFAULT NULL, date_ajout DATETIME NOT NULL, updated_at DATETIME DEFAULT NULL, online TINYINT(1) NOT NULL, is_recruting TINYINT(1) NOT NULL, slug VARCHAR(255) DEFAULT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_clanpostulation (id INT AUTO_INCREMENT NOT NULL, postulant_id INT DEFAULT NULL, clan_id INT DEFAULT NULL, date_ajout DATETIME NOT NULL, date_changement_etat DATETIME DEFAULT NULL, etat SMALLINT NOT NULL, INDEX IDX_9E6521521CD30E78 (postulant_id), INDEX IDX_9E652152BEAF84C8 (clan_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_clanproposition (id INT AUTO_INCREMENT NOT NULL, recruteur_id INT DEFAULT NULL, postulant_id INT DEFAULT NULL, date_ajout DATETIME NOT NULL, date_changement_etat DATETIME DEFAULT NULL, etat SMALLINT NOT NULL, INDEX IDX_83D5AC9ABB0859F1 (recruteur_id), INDEX IDX_83D5AC9A1CD30E78 (postulant_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_clanutilisateur (id INT AUTO_INCREMENT NOT NULL, membre_id INT DEFAULT NULL, recruteur_id INT DEFAULT NULL, clan_id INT DEFAULT NULL, droit SMALLINT NOT NULL, can_edit_clan TINYINT(1) NOT NULL, date_ajout DATETIME NOT NULL, UNIQUE INDEX UNIQ_59040C7A6A99F74A (membre_id), INDEX IDX_59040C7ABB0859F1 (recruteur_id), INDEX IDX_59040C7ABEAF84C8 (clan_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_comment (id INT AUTO_INCREMENT NOT NULL, thread_id INT DEFAULT NULL, author_id INT DEFAULT NULL, date_ajout DATETIME NOT NULL, body LONGTEXT NOT NULL, old_id INT DEFAULT NULL, INDEX IDX_4F5A214E2904019 (thread_id), INDEX IDX_4F5A214F675F31B (author_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_forum (id INT AUTO_INCREMENT NOT NULL, clan_id INT DEFAULT NULL, old_id INT DEFAULT NULL, nom VARCHAR(255) NOT NULL, ordre SMALLINT NOT NULL, can_user_create_thread TINYINT(1) NOT NULL, num_threads INT NOT NULL, date_ajout DATETIME NOT NULL, slug VARCHAR(255) DEFAULT NULL, INDEX IDX_6B56A2ABEAF84C8 (clan_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_thread (id INT AUTO_INCREMENT NOT NULL, forum_id INT DEFAULT NULL, author_id INT DEFAULT NULL, old_id INT DEFAULT NULL, is_postit TINYINT(1) NOT NULL, is_event TINYINT(1) NOT NULL, date_event_start DATE DEFAULT NULL, date_event_end DATE DEFAULT NULL, is_commentable TINYINT(1) NOT NULL, nom VARCHAR(255) NOT NULL, date_ajout DATETIME NOT NULL, body LONGTEXT NOT NULL, url_video VARCHAR(255) DEFAULT NULL, num_comments INT NOT NULL, last_comment_at DATETIME DEFAULT NULL, slug VARCHAR(255) DEFAULT NULL, lastCommentBy_id INT DEFAULT NULL, INDEX IDX_FCDA58C29CCBAD0 (forum_id), INDEX IDX_FCDA58CF675F31B (author_id), INDEX IDX_FCDA58C168FCBFD (lastCommentBy_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_lobby (id INT AUTO_INCREMENT NOT NULL, carte SMALLINT NOT NULL, partie SMALLINT NOT NULL, maximum SMALLINT NOT NULL, jeu SMALLINT NOT NULL, privee VARCHAR(30) NOT NULL, version NUMERIC(10, 6) NOT NULL, date_debut DATETIME NOT NULL, date_update DATETIME NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_ninja (id INT AUTO_INCREMENT NOT NULL, user_id INT DEFAULT NULL, aptitude_force SMALLINT NOT NULL, aptitude_vitesse SMALLINT NOT NULL, aptitude_vie SMALLINT NOT NULL, aptitude_chakra SMALLINT NOT NULL, jutsu_boule SMALLINT NOT NULL, jutsu_double_saut SMALLINT NOT NULL, jutsu_bouclier SMALLINT NOT NULL, jutsu_marcher_mur SMALLINT NOT NULL, jutsu_deflagration SMALLINT NOT NULL, jutsu_transformation_aqueuse SMALLINT NOT NULL, jutsu_metamorphose SMALLINT NOT NULL, jutsu_multishoot SMALLINT NOT NULL, jutsu_invisibilite SMALLINT NOT NULL, jutsu_resistance_explosion SMALLINT NOT NULL, jutsu_phoenix SMALLINT NOT NULL, jutsu_vague SMALLINT NOT NULL, jutsu_pieux SMALLINT NOT NULL, jutsu_teleportation SMALLINT NOT NULL, jutsu_tornade SMALLINT NOT NULL, jutsu_kusanagi SMALLINT NOT NULL, jutsu_acier_renforce SMALLINT NOT NULL, jutsu_chakra_vie SMALLINT NOT NULL, jutsu_fujin SMALLINT NOT NULL, jutsu_raijin SMALLINT NOT NULL, jutsu_sarutahiko SMALLINT NOT NULL, jutsu_susanoo SMALLINT NOT NULL, jutsu_kagutsuchi SMALLINT NOT NULL, grade SMALLINT NOT NULL, experience BIGINT NOT NULL, classe VARCHAR(25) NOT NULL, masque SMALLINT NOT NULL, masque_couleur SMALLINT NOT NULL, masque_detail SMALLINT NOT NULL, costume SMALLINT NOT NULL, costume_couleur SMALLINT NOT NULL, costume_detail SMALLINT NOT NULL, mission_assassinnat SMALLINT NOT NULL, mission_course SMALLINT NOT NULL, accomplissement VARCHAR(25) NOT NULL, UNIQUE INDEX UNIQ_C27E6696A76ED395 (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE reset_password_request (id INT AUTO_INCREMENT NOT NULL, user_id INT NOT NULL, selector VARCHAR(20) NOT NULL, hashed_token VARCHAR(100) NOT NULL, requested_at DATETIME NOT NULL COMMENT '(DC2Type:datetime_immutable)', expires_at DATETIME NOT NULL COMMENT '(DC2Type:datetime_immutable)', INDEX IDX_7CE748AA76ED395 (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_capture (id INT AUTO_INCREMENT NOT NULL, user_id INT DEFAULT NULL, url VARCHAR(255) NOT NULL, url_tmb VARCHAR(255) NOT NULL, delete_hash VARCHAR(255) NOT NULL, date_ajout DATETIME NOT NULL, INDEX IDX_1B7F569DA76ED395 (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_friend (id INT AUTO_INCREMENT NOT NULL, user_id INT DEFAULT NULL, friend_id INT DEFAULT NULL, is_blocked TINYINT(1) NOT NULL, is_confirmed TINYINT(1) NOT NULL, date_ajout DATETIME NOT NULL, INDEX IDX_6B03456EA76ED395 (user_id), INDEX IDX_6B03456E6A5458E8 (friend_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_group (id INT AUTO_INCREMENT NOT NULL, name VARCHAR(255) NOT NULL, roles LONGTEXT NOT NULL COMMENT '(DC2Type:array)', PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_ip (id INT AUTO_INCREMENT NOT NULL, user_id INT DEFAULT NULL, ip INT UNSIGNED NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME DEFAULT NULL, INDEX IDX_87A7C1A5A76ED395 (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_message (id INT AUTO_INCREMENT NOT NULL, author_id INT DEFAULT NULL, old_id INT DEFAULT NULL, nom VARCHAR(255) NOT NULL, content LONGTEXT NOT NULL, date_ajout DATETIME NOT NULL, has_deleted TINYINT(1) NOT NULL, INDEX IDX_263CC007F675F31B (author_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_messageuser (id INT AUTO_INCREMENT NOT NULL, message_id INT DEFAULT NULL, destinataire_id INT DEFAULT NULL, date_read DATETIME DEFAULT NULL, has_deleted TINYINT(1) NOT NULL, INDEX IDX_201584B2537A1329 (message_id), INDEX IDX_201584B2A4F84F6E (destinataire_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_user (id INT AUTO_INCREMENT NOT NULL, created_at DATETIME NOT NULL, updated_at DATETIME NOT NULL, username VARCHAR(255) NOT NULL, username_canonical VARCHAR(255) NOT NULL, email VARCHAR(255) NOT NULL, email_canonical VARCHAR(255) NOT NULL, enabled TINYINT(1) NOT NULL, salt VARCHAR(255) NOT NULL, password VARCHAR(255) NOT NULL, last_login DATETIME DEFAULT NULL, confirmation_token VARCHAR(255) DEFAULT NULL, password_requested_at DATETIME DEFAULT NULL, roles LONGTEXT NOT NULL COMMENT '(DC2Type:array)', old_id INT DEFAULT NULL, old_login VARCHAR(255) DEFAULT NULL, description LONGTEXT DEFAULT NULL, avatar VARCHAR(255) DEFAULT NULL, receive_newsletter TINYINT(1) NOT NULL, receive_avertissement TINYINT(1) NOT NULL, locked TINYINT(1) NOT NULL, old_usernames LONGTEXT NOT NULL COMMENT '(DC2Type:array)', old_usernames_canonical VARCHAR(255) NOT NULL, auto_login VARCHAR(255) DEFAULT NULL, date_of_birth DATETIME DEFAULT NULL, biography VARCHAR(255) DEFAULT NULL, gender VARCHAR(1) DEFAULT NULL, locale VARCHAR(8) DEFAULT NULL, timezone VARCHAR(64) DEFAULT NULL, date_application DATETIME DEFAULT NULL, date_message DATETIME DEFAULT NULL, number_application INT DEFAULT NULL, slug VARCHAR(255) DEFAULT NULL, UNIQUE INDEX UNIQ_C0C2F65E92FC23A8 (username_canonical), UNIQUE INDEX UNIQ_C0C2F65EA0D96FBF (email_canonical), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE nt_lobby_user (user_id INT NOT NULL, lobby_id INT NOT NULL, INDEX IDX_CB345EC2A76ED395 (user_id), INDEX IDX_CB345EC2B6612FD9 (lobby_id), PRIMARY KEY(user_id, lobby_id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE session (session_id VARBINARY(128) NOT NULL, session_value LONGBLOB NOT NULL, session_lifetime INT UNSIGNED NOT NULL, session_time INT UNSIGNED NOT NULL, INDEX session_lifetime_idx (session_lifetime), PRIMARY KEY(session_id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_bin` ENGINE = InnoDB;
CREATE TABLE acl_classes (id INT UNSIGNED AUTO_INCREMENT NOT NULL, class_type VARCHAR(200) NOT NULL, UNIQUE INDEX UNIQ_69DD750638A36066 (class_type), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE acl_security_identities (id INT UNSIGNED AUTO_INCREMENT NOT NULL, identifier VARCHAR(200) NOT NULL, username TINYINT(1) NOT NULL, UNIQUE INDEX UNIQ_8835EE78772E836AF85E0677 (identifier, username), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE acl_object_identities (id INT UNSIGNED AUTO_INCREMENT NOT NULL, parent_object_identity_id INT UNSIGNED DEFAULT NULL, class_id INT UNSIGNED NOT NULL, object_identifier VARCHAR(100) NOT NULL, entries_inheriting TINYINT(1) NOT NULL, UNIQUE INDEX UNIQ_9407E5494B12AD6EA000B10 (object_identifier, class_id), INDEX IDX_9407E54977FA751A (parent_object_identity_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE acl_object_identity_ancestors (object_identity_id INT UNSIGNED NOT NULL, ancestor_id INT UNSIGNED NOT NULL, INDEX IDX_825DE2993D9AB4A6 (object_identity_id), INDEX IDX_825DE299C671CEA1 (ancestor_id), PRIMARY KEY(object_identity_id, ancestor_id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
CREATE TABLE acl_entries (id INT UNSIGNED AUTO_INCREMENT NOT NULL, class_id INT UNSIGNED NOT NULL, object_identity_id INT UNSIGNED DEFAULT NULL, security_identity_id INT UNSIGNED NOT NULL, field_name VARCHAR(50) DEFAULT NULL, ace_order SMALLINT UNSIGNED NOT NULL, mask INT NOT NULL, granting TINYINT(1) NOT NULL, granting_strategy VARCHAR(30) NOT NULL, audit_success TINYINT(1) NOT NULL, audit_failure TINYINT(1) NOT NULL, UNIQUE INDEX UNIQ_46C8B806EA000B103D9AB4A64DEF17BCE4289BF4 (class_id, object_identity_id, field_name, ace_order), INDEX IDX_46C8B806EA000B103D9AB4A6DF9183C9 (class_id, object_identity_id, security_identity_id), INDEX IDX_46C8B806EA000B10 (class_id), INDEX IDX_46C8B8063D9AB4A6 (object_identity_id), INDEX IDX_46C8B806DF9183C9 (security_identity_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8mb4 COLLATE `utf8mb4_unicode_ci` ENGINE = InnoDB;
ALTER TABLE nt_clanpostulation ADD CONSTRAINT FK_9E6521521CD30E78 FOREIGN KEY (postulant_id) REFERENCES nt_user (id) ON DELETE CASCADE;
ALTER TABLE nt_clanpostulation ADD CONSTRAINT FK_9E652152BEAF84C8 FOREIGN KEY (clan_id) REFERENCES nt_clan (id) ON DELETE CASCADE;
ALTER TABLE nt_clanproposition ADD CONSTRAINT FK_83D5AC9ABB0859F1 FOREIGN KEY (recruteur_id) REFERENCES nt_user (id) ON DELETE CASCADE;
ALTER TABLE nt_clanproposition ADD CONSTRAINT FK_83D5AC9A1CD30E78 FOREIGN KEY (postulant_id) REFERENCES nt_user (id) ON DELETE CASCADE;
ALTER TABLE nt_clanutilisateur ADD CONSTRAINT FK_59040C7A6A99F74A FOREIGN KEY (membre_id) REFERENCES nt_user (id);
ALTER TABLE nt_clanutilisateur ADD CONSTRAINT FK_59040C7ABB0859F1 FOREIGN KEY (recruteur_id) REFERENCES nt_user (id);
ALTER TABLE nt_clanutilisateur ADD CONSTRAINT FK_59040C7ABEAF84C8 FOREIGN KEY (clan_id) REFERENCES nt_clan (id) ON DELETE CASCADE;
ALTER TABLE nt_comment ADD CONSTRAINT FK_4F5A214E2904019 FOREIGN KEY (thread_id) REFERENCES nt_thread (id) ON DELETE CASCADE;
ALTER TABLE nt_comment ADD CONSTRAINT FK_4F5A214F675F31B FOREIGN KEY (author_id) REFERENCES nt_user (id) ON DELETE CASCADE;
ALTER TABLE nt_forum ADD CONSTRAINT FK_6B56A2ABEAF84C8 FOREIGN KEY (clan_id) REFERENCES nt_clan (id);
ALTER TABLE nt_thread ADD CONSTRAINT FK_FCDA58C29CCBAD0 FOREIGN KEY (forum_id) REFERENCES nt_forum (id) ON DELETE CASCADE;
ALTER TABLE nt_thread ADD CONSTRAINT FK_FCDA58CF675F31B FOREIGN KEY (author_id) REFERENCES nt_user (id) ON DELETE CASCADE;
ALTER TABLE nt_thread ADD CONSTRAINT FK_FCDA58C168FCBFD FOREIGN KEY (lastCommentBy_id) REFERENCES nt_user (id) ON DELETE SET NULL;
ALTER TABLE nt_ninja ADD CONSTRAINT FK_C27E6696A76ED395 FOREIGN KEY (user_id) REFERENCES nt_user (id) ON DELETE CASCADE;
ALTER TABLE reset_password_request ADD CONSTRAINT FK_7CE748AA76ED395 FOREIGN KEY (user_id) REFERENCES nt_user (id);
ALTER TABLE nt_capture ADD CONSTRAINT FK_1B7F569DA76ED395 FOREIGN KEY (user_id) REFERENCES nt_user (id) ON DELETE CASCADE;
ALTER TABLE nt_friend ADD CONSTRAINT FK_6B03456EA76ED395 FOREIGN KEY (user_id) REFERENCES nt_user (id) ON DELETE CASCADE;
ALTER TABLE nt_friend ADD CONSTRAINT FK_6B03456E6A5458E8 FOREIGN KEY (friend_id) REFERENCES nt_user (id) ON DELETE CASCADE;
ALTER TABLE nt_ip ADD CONSTRAINT FK_87A7C1A5A76ED395 FOREIGN KEY (user_id) REFERENCES nt_user (id);
ALTER TABLE nt_message ADD CONSTRAINT FK_263CC007F675F31B FOREIGN KEY (author_id) REFERENCES nt_user (id) ON DELETE CASCADE;
ALTER TABLE nt_messageuser ADD CONSTRAINT FK_201584B2537A1329 FOREIGN KEY (message_id) REFERENCES nt_message (id) ON DELETE CASCADE;
ALTER TABLE nt_messageuser ADD CONSTRAINT FK_201584B2A4F84F6E FOREIGN KEY (destinataire_id) REFERENCES nt_user (id) ON DELETE CASCADE;
ALTER TABLE nt_lobby_user ADD CONSTRAINT FK_CB345EC2A76ED395 FOREIGN KEY (user_id) REFERENCES nt_user (id) ON DELETE CASCADE;
ALTER TABLE nt_lobby_user ADD CONSTRAINT FK_CB345EC2B6612FD9 FOREIGN KEY (lobby_id) REFERENCES nt_lobby (id) ON DELETE CASCADE;
ALTER TABLE acl_object_identities ADD CONSTRAINT FK_9407E54977FA751A FOREIGN KEY (parent_object_identity_id) REFERENCES acl_object_identities (id);
ALTER TABLE acl_object_identity_ancestors ADD CONSTRAINT FK_825DE2993D9AB4A6 FOREIGN KEY (object_identity_id) REFERENCES acl_object_identities (id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE acl_object_identity_ancestors ADD CONSTRAINT FK_825DE299C671CEA1 FOREIGN KEY (ancestor_id) REFERENCES acl_object_identities (id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE acl_entries ADD CONSTRAINT FK_46C8B806EA000B10 FOREIGN KEY (class_id) REFERENCES acl_classes (id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE acl_entries ADD CONSTRAINT FK_46C8B8063D9AB4A6 FOREIGN KEY (object_identity_id) REFERENCES acl_object_identities (id) ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE acl_entries ADD CONSTRAINT FK_46C8B806DF9183C9 FOREIGN KEY (security_identity_id) REFERENCES acl_security_identities (id) ON UPDATE CASCADE ON DELETE CASCADE;
